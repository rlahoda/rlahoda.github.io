
<!DOCTYPE html>
<html lang="en" dir="ltr">
  
<head>
  <script>
    (function(i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function() {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-32142472-2', 'auto');
    ga('send', 'pageview');
  </script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- <meta http-equiv="Content-Security-Policy" content="default-src 'self'"> -->
  <title>Rob Lahoda • Front End Web Developer</title>
  <!-- <base href="https://rlahoda.github.io"> -->
  <link rel="stylesheet" href="/css/styles.css">
  <link href="/vendor/prism/prism.css" rel="stylesheet" />
  <meta name="description" content="I'm a versatile, adaptable problem-solver. My strong mix of technical and creative skills give me a diverse perspective on the projects I work on.">
  <meta name="subject" content="">

  <meta property="og:url" content="https://rlahoda.github.io">
  <meta property="og:type" content="website">
  <meta property="og:title" content="Rob Lahoda • Front End Web Developer">
  <meta property="og:image" content="https://rlahoda.github.io/assets/images/social-twitter.jpg">
  <meta property="og:description" content="I'm a versatile, adaptable problem-solver. My strong mix of technical and creative skills give me a diverse perspective on the projects I work on.">
  <meta property="og:site_name" content="Rob Lahoda • Front End Web Developer">
  <meta property="og:locale" content="en_US">
  <meta property="article:author" content="">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@rlahoda">
  <meta name="twitter:creator" content="@rlahoda">
  <meta name="twitter:url" content="https://rlahoda.github.io">
  <meta name="twitter:title" content="Rob Lahoda • Front End Web Developer">
  <meta name="twitter:description" content="I'm a versatile, adaptable problem-solver. My strong mix of technical and creative skills give me a diverse perspective on the projects I work on.">
  <meta name="twitter:image" content="https://rlahoda.github.io/assets/images/social-twitter.jpg">

  <meta name="robots" content="index,follow"><!-- All Search Engines -->
  <meta name="googlebot" content="index,follow"><!-- Google Specific -->

  <!-- <script src="/vendor/greensock-js/src/minified/TweenMax.min.js" charset="utf-8"></script>
  <script src="/vendor/greensock-js/src/minified/plugins/TextPlugin.min.js" charset="utf-8"></script>
  <script src="/vendor/greensock-js/src/minified/easing/EasePack.min.js" charset="utf-8"></script> -->
  <script src="/scripts/scripts-min.js" charset="utf-8"></script>
  <link href="https://fonts.googleapis.com/css?family=Montserrat:300,700,900" rel="stylesheet">
</head>

  <body>
    <nav class="navFixed">
  <ul id="navList" class="navList">
    <li class="navList__navItem" id="navList__homeLink"><a href="../">Home</a></li>
    <li class="navList__navItem" id="navList__aboutLink"><a href="../about.html">About</a></li>
    <li class="navList__navItem" id="navList__projectsLink"><a href="../projects.html">Projects</a></li>
    <li class="navList__navItem" id="navList__projectsLink"><a href="../blog.html">Blog</a></li>
    <li class="navList__navItem" id="navList__contactLink"><a href="../contact.html">Contact</a></li>
  </ul>
</nav>
    <header>
      <div class="pageTopImage">
        
              </div>
    </header>

    <main>
      <div class="pageHeading">
        <!-- <h1 class="bigTitle">
          Blog</h1> -->
        <div class="pageTagline__container">

                  <h1 id="projectsTagline" class="pageTagline"> Getting Greensock Animation (GSAP) Running With React Hooks</h1>
        <h2>Jan 27, 2020</h2>
        </div>
        <p></p>
      </div>
      <div class="blogContainer">

        <div class="blogCard recentPosts">
          <h3 class="noMargin">Check Out Some Recent Posts:</h3>
          <ul class="noList linkList">
                        <li class="linkList-links"><a href="leaflet-react-custom-icons.html">React Leaflet Custom Map Icons</a></br>
            <p class="noMargin indented">Nov 19, 2019</p></li>
                        <li class="linkList-links"><a href="use-const-even-when-you-think-you-shouldnt.html">Use 'const', Even When You Think You Shouldn't</a></br>
            <p class="noMargin indented">Jan 23, 2019</p></li>
                        <li class="linkList-links"><a href="an-easy-way-to-practice-with-twig-without-drupal.html">An Easy Way To Practice With Twig Without Drupal</a></br>
            <p class="noMargin indented">Mar 28, 2018</p></li>
                        <li class="linkList-links"><a href="hiding-progress-bar-steps-in-drupal-8-webform.html">Hiding Progress Bar Steps in Drupal 8 Webform</a></br>
            <p class="noMargin indented">Mar 26, 2018</p></li>
                      </ul>

        </div>
        <div class="blogCard">
          <a href="/blog.html">Back to the blog</a>
                <hr>
<p>templateKey: blog-post
title: Getting Greensock Animation (GSAP) Running With React Hooks
date: 2020-01-26T20:59:38.188Z
description: &gt;-
  I recently have been working on moving my website from my own twig-based build
  system to Gatsby.js with Netlify CMS. I&#39;m working on a separate blog post for
  a recap on that, but one of the challenges I had with the switch was moving
  the Greensock Animation Platform (GSAP) animations I had set up over to work
  in React.
tags:</p>
<ul>
<li>React</li>
<li>Learning</li>
<li>GSAP</li>
</ul>
<hr>
<p>I recently have been working on moving my website from my own twig-based build system to <a href="https://www.gatsbyjs.org/">Gatsby.js</a> with <a href="https://www.netlifycms.org/">Netlify CMS</a>. I&#39;m working on a separate blog post for a recap on that, but one of the challenges I had with the switch was moving the <a href="https://greensock.com/gsap/">Greensock Animation Platform (GSAP)</a> animations I had set up over to work in <a href="https://reactjs.org/">React</a>. Since React has its own way of doing some things compared to straight Javascript, I did some digging around to find a good solution for what the differences would be. </p>
<p><em><strong>Please Note:</strong> This post assumes you have a knowledge of working with GSAP. If not, it will be best to first learn about the platform in a standard Javascript project before moving it into a React project</em></p>
<p>The first major difference is that React doesn&#39;t let you directly access the document object model (DOM) to directly interact with elements on the page. To get around this, GSAP suggests that you use refs to do this direct manipulation. The other thing I learned was that if you create a timeline normally, new timelines will continue to be added every time the page refreshes, which will lead to memory issues. To get around this will mean using some of the lifecycle features in React to only load the code once.</p>
<h2 id="react-hooks">React Hooks</h2>
<p>Since I&#39;ve been doing most of my work in functional components, I need to use <a href="https://reactjs.org/docs/hooks-intro.html">React Hooks</a> to replicate some of the necessary lifecycle capabilities. The main one is creating <a href="https://reactjs.org/docs/hooks-reference.html#useref">refs</a>. The other one is using <a href="https://reactjs.org/docs/hooks-reference.html#useeffect">useEffect()</a> to take the place of <a href="https://reactjs.org/docs/state-and-lifecycle.html">componentDidMount()</a>.</p>
<h2 id="using-refs">Using Refs</h2>
<p>The process of creating a ref is very simple. Just use <code>let tl=useRef();</code> at the top of the component to add a ref. According to the documentation, the <code>.current</code> property of the ref is usable to store information that won&#39;t change when the component is reloaded, so it&#39;s perfect for keeping the timeline in place despite other data changing.</p>
<p>In this case, the ref, in this case we&#39;ve named it <code>tl</code> for &quot;timeline&quot;, will be used to store the timeline for the animation:</p>
<pre><code class="language-js">tl.current = new TimelineMax();
</code></pre>
<p>Then it will be referenced to add the ongoing parameters and information necessary:</p>
<pre><code class="language-javascript">tl.current.delay(2);
tl2.current.to(id, 1.5, { opacity: 0 });
</code></pre>
<h2 id="useeffect">useEffect()</h2>
<p>To make sure that the code is only loaded once, the <code>useEffect()</code> hook is used. Since <code>useEffect()</code> can cover most of the lifecycle steps, there&#39;s a specific way to format it to only load once:</p>
<pre><code class="language-javascript">  useEffect(() =&gt; {
       // code goes here
  }, []);
</code></pre>
<p>The empty array parameter ( <code>[]</code> ) at the end is what is used to ensure that the hook won&#39;t be called repeatedly as the component updates. </p>
<h2 id="putting-it-together">Putting it together</h2>
<p>So how this all works together is you need to start by importing GSAP just like you would import any other package:</p>
<pre><code class="language-Javascript">import gsap from &quot;gsap&quot;;
</code></pre>
<p><strong>However</strong>, depending on what you&#39;re doing, you might only need to import the specific feature you&#39;re using, such as <code>TimelineMax</code>:</p>
<pre><code class="language-Javascript">import { TimelineMax } from &quot;gsap&quot;;
</code></pre>
<p>Then you can write your code for the timeline as you normally would, using the <code>tl.current</code> ref to store everything and either writing the code directly in <code>useEffect()</code> or referencing a function containing it in <code>useEffect()</code>. </p>
<p>This code is running the boxes fading on the front page of this site. It gets a random ID number from 1-28 (there are 28 boxes) and adds a timeline to them to fade out and in at different times. At the end of adding a timeline to a box, it uses the callback to start over again and add a timeline to another box.</p>
<pre><code class="language-Javascript">// This function just generates a random number between 1 and 28
  function getRandom(min, max) {
    let randomNumber = Math.floor(Math.random() * (max - min)) + 1;
    return randomNumber;
  }

// This function chooses a random box and adds the fade out / fade in timeline to it
  function boxesHeaderRandom() {
    tl.current = new TimelineMax();
    for (var i = 0; i &lt; 10; i++) {
      let randomId = getRandom(1, 28);
      let elId = &quot;#nameImage__container--box--&quot; + randomId;
      tl.current.to(elId, 2, { opacity: 0 });
      tl.current.to(elId, 2, { opacity: 1 });
    }
    tl.current.eventCallback(&quot;onComplete&quot;, boxesHeaderRandom);
  }

// The useEffect() hook is used here to start the sequence once when the component is loaded
  useEffect(() =&gt; {
    boxesHeaderRandom();
  }, []);
</code></pre>
<p>I found that if I didn&#39;t import <code>TimelineMax</code> directly and tried to just use <code>gsap.TimelineMax</code> I got errors, so be sure to import each feature directly. </p>
<h2 id="tying-the-animation-to-an-element">Tying the animation to an element</h2>
<p>To take the animation created and actually tie it to one of your elements, the <code>ref</code> needs to be referenced by that object. This is done by just adding a <code>ref</code> prop to the element in the <code>return</code> statement:</p>
<pre><code class="language-javascript"> return (
      &lt;h2 ref={tl} id=&quot;indexTagline&quot; className=&quot;pageTagline&quot;&gt;
        I Build Websites
      &lt;/h2&gt;
  );
}
</code></pre>
<p>In this instance, the <code>h2</code> element has the <code>ref={tl}</code> prop added to it to tie the <code>h2</code> to the timeline <code>ref</code> created earlier.</p>
<h2 id="using-gsap-plugins">Using GSAP Plugins</h2>
<p>In one of the animations, I use both the <code>TextPlugin</code> and <code>EasePack</code> plugins. To get access to the basic plugins that come standard with GSAP, the first step is to import them as you would with any other React project. Most of these can be found by just looking in the <code>gsap</code> folder of the <code>node_modules</code> directory. There&#39;s also an <code>all</code> file that is available to export from as well. Some more information can be found at the NPM section on the <a href="https://greensock.com/docs/v3/Installation#npm">GSAP installation page</a>. <em>Note: I did find more information that was more helpful on the <a href="https://greensock.com/docs/v2/NPMUsage">v2 docs NPM page</a> but be aware that some things might have changed between v2 and v3 so you might need to double check if you&#39;re having issues.</em></p>
<pre><code class="language-javascript">// individual imports

import TextPlugin from &quot;gsap/TextPlugin&quot;;
import EasePack from &quot;gsap/EasePack&quot;;

// using the &quot;all&quot; file for importing

import {TextPlugin, EasePack} from &quot;gsap/All&quot;;
</code></pre>
<p>Once the plugins are imported, the next step is to register them with GSAP:</p>
<pre><code class="language-javascript">gsap.registerPlugin(TextPlugin, EasePack);
</code></pre>
<p>Now they&#39;re ready to be used as normal inside the code. No special references are needed like <code>TextPlugin.text</code> or something.</p>
<pre><code class="language-javascript"> tl.current.to(&quot;#indexTagline&quot;, {
        text: tagline,
        ease: Linear.easeNone,
        delay: 2
      });
</code></pre>
<p>In the code above, the <code>text: tagline</code> reference is using the <code>TextPlugin</code> plugin and <code>ease: Linear.easeNone</code> references the <code>EasePack</code> plugin. So registering the plugins with GSAP is all that&#39;s needed to make these function as they would otherwise outside of React.</p>
<h2 id="event-based-animations">Event-based animations</h2>
<p>To add an animation based on some kind of event, </p>
<h2 id="finished-component">Finished Component</h2>
<p>The finished component takes all of this and pulls it together:</p>
<pre><code class="language-Javascript">import React, { useRef, useEffect } from &quot;react&quot;;

// importing the main GSAP package and the specific feature being used
import gsap, { TimelineMax } from &quot;gsap&quot;;
// importing individual plugins
import TextPlugin from &quot;gsap/TextPlugin&quot;;
import EasePack from &quot;gsap/EasePack&quot;;

function Tagline() {
  // create a ref to be used to store the timeline
  let tl = useRef(); 

  // register plugins with GSAP
  gsap.registerPlugin(TextPlugin, EasePack); 

  let tagLines = [
    &quot;I Tell Stories&quot;,
    &quot;I Theme In Drupal&quot;,
    &quot;I Take Pictures&quot;,
    &quot;I&#39;m A Visual Storyteller&quot;,
    &quot;I Make Videos&quot;,
    &quot;I Develop In React&quot;,
    &quot;I Like Pizza&quot;,
    &quot;I Build Websites&quot;
  ];

  useEffect(() =&gt; {
    // create the timeline in .current 
    tl.current = new TimelineMax({ repeat: -1 }); 

    // add to the timeline as normal referencing the ref.current
    tl.current.delay(2);
    for (var i = 0; i &lt; tagLines.length; i++) {
      let tagline = tagLines[i];
      // use the plugins as normal
      tl.current.to(&quot;#indexTagline&quot;, {
        text: tagline,
        ease: Linear.easeNone,
        delay: 2
      });
    }
  }, []);

  return (
    &lt;div className=&quot;pageTagline__container&quot;&gt;

      {// add the ref to the individual element it needs to tie into}
      &lt;h2 ref={tl} id=&quot;indexTagline&quot; className=&quot;pageTagline&quot;&gt;
        I Build Websites
      &lt;/h2&gt;
    &lt;/div&gt;
  );
}

export default Tagline;
</code></pre>
<p>I hope this has been helpful for understanding how to add some GSAP animations to a React project. </p>
          <a href="/blog.html">Back to the blog</a>
        </div>
        <div class="blogContainer">
          <div class="blogCard recentPosts">
            <h3 class="noMargin">Check Out Some Recent Posts:</h3>
            <ul class="noList linkList">
                            <li class="linkList-links"><a href="leaflet-react-custom-icons.html">React Leaflet Custom Map Icons</a></br>
              <p class="noMargin indented">Nov 19, 2019</p></li>
                            <li class="linkList-links"><a href="use-const-even-when-you-think-you-shouldnt.html">Use 'const', Even When You Think You Shouldn't</a></br>
              <p class="noMargin indented">Jan 23, 2019</p></li>
                            <li class="linkList-links"><a href="an-easy-way-to-practice-with-twig-without-drupal.html">An Easy Way To Practice With Twig Without Drupal</a></br>
              <p class="noMargin indented">Mar 28, 2018</p></li>
                            <li class="linkList-links"><a href="hiding-progress-bar-steps-in-drupal-8-webform.html">Hiding Progress Bar Steps in Drupal 8 Webform</a></br>
              <p class="noMargin indented">Mar 26, 2018</p></li>
                          </ul>
          </div>
        </div>
      </div>
    </main>

    <footer>
  <div class="footerLinks__container">
    <h4 class="">Say Hi!</h4>
  <ul class="noList noListBlock footerLinks__list">
              <li class="footerLinks__list--item">
          <a class="footerLinks__link" href="mailto:rob@roblahoda.com" onclick="trackOutboundLink('rob@roblahoda.com'); return false;" target="_blank"><span class="icons footerLinks__link--icon" id="email"></span>
          <p class="">Email</p></a>
        </li>
              <li class="footerLinks__list--item">
          <a class="footerLinks__link" href="https://twitter.com/rlahoda" onclick="trackOutboundLink('https://twitter.com/rlahoda'); return false;" target="_blank"><span class="icons footerLinks__link--icon" id="twitter"></span>
          <p class="">Twitter</p></a>
        </li>
              <li class="footerLinks__list--item">
          <a class="footerLinks__link" href="https://github.com/rlahoda" onclick="trackOutboundLink('https://github.com/rlahoda'); return false;" target="_blank"><span class="icons footerLinks__link--icon" id="github"></span>
          <p class="">Github</p></a>
        </li>
              <li class="footerLinks__list--item">
          <a class="footerLinks__link" href="https://codepen.io/rlahoda/" onclick="trackOutboundLink('https://codepen.io/rlahoda/'); return false;" target="_blank"><span class="icons footerLinks__link--icon" id="codepen">
          </span>
          <p class="">Codepen</p></a>
        </li>
              <li class="footerLinks__list--item">
          <a class="footerLinks__link" href="https://www.drupal.org/u/rlahoda/" onclick="trackOutboundLink('https://www.drupal.org/u/rlahoda/'); return false;" target="_blank"><span class="icons footerLinks__link--icon" id="drupal"></span>
          <p class="">Drupal.org</p></a>
        </li>
              <li class="footerLinks__list--item">
          <a class="footerLinks__link" href="https://www.linkedin.com/in/robert-lahoda/" onclick="trackOutboundLink('https://www.linkedin.com/in/robert-lahoda/'); return false;" target="_blank"><span class="icons footerLinks__link--icon" id="linkedin"></span>
          <p class="">Linkedin</p></a>
        </li>
            </ul>
            <p class="smallText">Copyright &copy; <script>document.write(new Date().getFullYear())</script> Rob Lahoda - Logos are property of their respective owners.</p>

</div>
<script src="/vendor/prism/prism.js"></script>
</footer>
    <script type="text/javascript" src="/vendor/scroll.js"></script>
<script>
/**
* Function that tracks a click on an outbound link in Analytics.
* This function takes a valid URL string as an argument, and uses that URL string
* as the event label. Setting the transport method to 'beacon' lets the hit be sent
* using 'navigator.sendBeacon' in browser that support it.
*/
var trackOutboundLink = function(url) {
 ga('send', 'event', 'outbound', 'click', url, {
   'transport': 'beacon',
   'hitCallback': function(){document.location = url;}
 });
}
</script>
  </body>
</html>
